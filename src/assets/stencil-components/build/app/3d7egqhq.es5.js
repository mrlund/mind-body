/*! Built with http://stenciljs.com */
App.loadBundle("3d7egqhq",["exports"],function(t){var e=window.App.h,i=function(){function t(){this.isClassroomModeOn=!1,this.paused=!0,this.dataLoaded=!1,this.firstFramePath="",this.basePath="../../assets/project",this.isBusy=!1,this.formattedProgress="0"}return t.prototype.componentWillLoad=function(){var t=document.createElement("script");this.firstFramePath=this.basePath+this.project+"/session"+this.session+"/"+this.chapter+"/"+this.animation+"."+this.imgext,t.src=this.basePath+this.project+"/session"+this.session+"/"+this.chapter+"/"+this.animation+".js",document.body.appendChild(t);var e=this;window.playSound=function(t,i){return e.sound&&e.sound.stop(),e.sound=createjs.Sound.play(t,createjs.Sound.INTERRUPT_EARLY,0,0,i),e.sound}},t.prototype.loadAnimation=function(){var t=this;if(createjs.Sound.initializeDefaultPlugins()){this.canvas=document.getElementById("canvas1"),this.anim_container=document.getElementById("canvas-container"),this.dom_overlay_container=document.getElementById("dom_overlay_container"),this.comp=AdobeAn.getComposition(this.composition);var e=new createjs.LoadQueue(!1);e.installPlugin(createjs.Sound),e.addEventListener("complete",function(e){t.handleComplete(e)}),e.addEventListener("fileload",function(e){t.handleFileLoad(e)}),e.addEventListener("progress",this.handleQueueProgress(this)),e.loadManifest(lib.properties.manifest,!0,this.basePath+this.project+"/session"+this.session+"/"+this.chapter+"/")}},t.prototype.doneLoading=function(){this.isBusy=!1,this.dataLoaded=!0},t.prototype.handleFileLoad=function(t){var e=this.comp.getImages();t&&"image"==t.item.type&&(e[t.item.id]=t.result)},t.prototype.handleQueueProgress=function(t){return this.isBusy=!0,function(e){t.formattedProgress=e.loaded?(100*e.loaded).toFixed(0):"0",1==e.loaded&&t.doneLoading()}},t.prototype.handleComplete=function(t){for(var e=this.comp.getSpriteSheet(),i=t.target,n=this.comp.getLibrary(),o=n.ssMetadata,s=0;s<o.length;s++)e[o[s].name]=new createjs.SpriteSheet({images:[i.getResult(o[s].name)],frames:o[s].frames});this.exportRoot=new n[this.animation],this.stage=new n.Stage(this.canvas),this.makeResponsive(!0,"both",!1,1),AdobeAn.compositionLoaded(n.properties.id),this.fnStartAnimation()},t.prototype.fnStartAnimation=function(){console.log("start animation"),this.stage.addChild(this.exportRoot),createjs.Ticker.setFPS(lib.properties.fps),createjs.Ticker.addEventListener("tick",this.tickHandler(this)),this.paused=!1},t.prototype.makeResponsive=function(t,e,i,n){var o=this;console.log("make responsive"),window.addEventListener("resize",function(){return o.resizeCanvas(t,e,i,n)}),this.resizeCanvas(t,e,i,n)},t.prototype.resizeCanvas=function(t,e,i,n){console.log("resize canvas");var o,s,a=1,r=lib.properties.width,d=lib.properties.height,c=window.innerWidth,p=window.innerHeight,u=window.devicePixelRatio||1,l=c/r,h=p/d,m=1;t&&("width"==e&&o==c||"height"==e&&s==p?m=a:i?1==n?m=Math.min(l,h):2==n&&(m=Math.max(l,h)):(c<r||p<d)&&(m=Math.min(l,h)));var g=document.getElementById("canvas-container");this.canvas.width=r*u*m,this.canvas.height=d*u*m,this.canvas.style.width=this.dom_overlay_container.style.width=g.style.width=r*m+"px",this.canvas.style.height=g.style.height=this.dom_overlay_container.style.height=d*m+"px",this.stage.scaleX=u*m,this.stage.scaleY=u*m,o=c,s=p,a=m;var f=document.getElementById("canvas1").offsetWidth;this.sizeOfCanvas=f,this.stage.tickOnUpdate=!1,this.stage.update(),this.stage.tickOnUpdate=!0},t.prototype.resizeAnimation=function(t){if(this.dataLoaded){console.log(document.getElementById("canvas1")),console.log(this.dataLoaded);var e=document.getElementById("canvas1").offsetWidth;document.getElementById("canvas1").style.height=e+"px",document.getElementById("canvas1").style.width=e+"px",t.sizeOfCanvas=e,t.stage&&(t.stage.width=e,t.stage.height=e)}},t.prototype.tickHandler=function(t){var e=!1;return function(i){t.paused||i.paused||t.stage.update();var n=t.stage.children[0];if(t.timeline=n.timeline,t.timeline.position%10==0&&(t.currentProgressWidth=parseFloat((t.timeline.position/t.timeline.duration*t.sizeOfCanvas).toFixed(0))),0==t.timeline.position&&(e=!1),t.timeline.duration-t.timeline.position==1&&!e){e=!0,createjs.Ticker.setPaused(!0);var o=t.sound;o&&o.setPaused(!0)}}},t.prototype.playPauseAnimation=function(){if(createjs&&createjs.Ticker){var t=!createjs.Ticker.getPaused(),e=this.sound;e&&e.setPaused(t),createjs.Ticker.setPaused(t),this.paused=t}},t.prototype.rewindAnimationTo=function(t,e){var i=this.stage.children[0],n=i.timeline;t<0&&(t=0),t>n.duration&&(t=n.duration-10);var o=this.sound;o&&o.setPaused(!0),this.sound.setPosition(e),this.paused?(i.gotoAndStop(t),this.stage.update(),o&&!o.getPaused()&&o.setPaused(!0)):(i.gotoAndPlay(t),o.setPaused(!1))},t.prototype.rewindAnimation=function(t){t.stopPropagation();var e=this.stage.children[0].timeline,i=Math.round(t.offsetX/this.sizeOfCanvas*e.duration),n=this.sound.position+5e3;this.rewindAnimationTo(i,n)},t.prototype.rewind5Sec=function(){var t=lib.properties.fps,e=this.stage.children[0].timeline.position-5*t,i=this.sound.position-5e3;this.rewindAnimationTo(e,i)},t.prototype.fastForward5Sec=function(){var t=lib.properties.fps,e=this.stage.children[0].timeline.position+5*t,i=this.sound.position+5e3;this.rewindAnimationTo(e,i)},t.prototype.playButtonAction=function(){this.dataLoaded?this.playPauseAnimation():this.loadAnimation()},t.prototype.canvasPlayAnimation=function(){if(this.dataLoaded){if(createjs&&createjs.Ticker){var t=this.sound;t&&t.setPaused(!1),createjs.Ticker.setPaused(!1),this.paused=!1}}else this.loadAnimation()},t.prototype.canvasPauseAnimation=function(){if(createjs&&createjs.Ticker){var t=this.sound;t&&t.setPaused(!0),createjs.Ticker.setPaused(!0),this.paused=!0}},t.prototype.muteVolume=function(){var t=this.sound;t&&(t.volume=0)},t.prototype.downVolume=function(){var t=this.sound;t&&t._getVolume()>.9&&(t.volume=t._getVolume()-.1)},t.prototype.upVolume=function(){var t=this.sound;t&&t._getVolume()<1&&(t.volume=t._getVolume()+.1)},t.prototype.render=function(){var t=this;return e("div",null,e("div",{class:"canvas-container",id:"canvas-container"},this.isClassroomModeOn?"":e("div",null,e("canvas",{id:"canvas1",onClick:function(){return t.playButtonAction()},class:"video-canvas"}),e("div",{id:"dom_overlay_container"})),this.dataLoaded?"":e("img",{class:"frame-img",src:this.firstFramePath}),this.isClassroomModeOn?e("img",{class:"overlay-img",src:"/assets/img/play-button-disabled-overlay.png"}):"",!this.isClassroomModeOn&&this.paused?e("img",{class:"overlay-img",onClick:function(){return t.playButtonAction()},src:"/assets/img/play-button-overlay.png"}):"",this.isBusy?e("div",null,e("div",{class:"uil-ring-css"},e("div",null),e("a",null,this.formattedProgress))):""),this.dataLoaded?e("div",{class:"navControls"},e("div",{class:"progressBar",onClick:function(){return t.rewindAnimation.bind(t)}},e("div",{class:"currentProgress",style:{width:this.currentProgressWidth+"px"}})),e("div",{class:"button-panel"},e("ion-button",{color:"primary",onClick:function(){return t.rewind5Sec()}}," ",e("ion-icon",{name:"rewind"})," "),e("ion-button",{color:"primary",onClick:function(){return t.playButtonAction()}}," ",this.paused?e("ion-icon",{name:"play"}):e("ion-icon",{name:"pause"})),e("ion-button",{color:"primary",onClick:function(){return t.fastForward5Sec()}}," ",e("ion-icon",{name:"fastforward"})," "))):"")},Object.defineProperty(t,"is",{get:function(){return"app-animation"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{animation:{type:String,attr:"animation"},canvasPauseAnimation:{method:!0},canvasPlayAnimation:{method:!0},chapter:{type:String,attr:"chapter"},composition:{type:String,attr:"composition"},currentProgressWidth:{state:!0},dataLoaded:{state:!0},imgext:{type:String,attr:"imgext"},isClassroomModeOn:{type:Boolean,attr:"is-classroom-mode-on"},paused:{state:!0},project:{type:String,attr:"project"},session:{type:String,attr:"session"},sizeOfCanvas:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return".video-canvas{position:absolute;display:block;background-color:#fff;width:auto;height:500px}.canvas-container{position:relative;background-color:#fff;width:auto;height:500px}.frame-img{position:absolute;display:block;max-width:100%;width:auto;height:auto}.overlay-img{position:absolute;z-index:9999;top:0;display:block;max-width:100%;width:auto;height:auto}.button-panel{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.navControls{position:relative}.navControls .progressBar{position:relative;left:0;right:0;height:20px;background-color:#8aadea}.navControls .progressBar .currentProgress{position:relative;height:20px;background-color:#488aff;-webkit-transition:width .5s;transition:width .5s}#dom_overlay_container{pointer-events:none;overflow:hidden;width:800px;height:800px;position:absolute;left:0;top:0;display:block}"},enumerable:!0,configurable:!0}),t}(),n=function(){function t(){}return t.prototype.render=function(){return e("ion-page",{class:"show-page"},e("ion-header",{"md-height":"56px"},e("ion-toolbar",{color:"primary"},e("ion-title",null,"G3DA PWA"))),e("ion-content",null,e("app-animation",{project:"1",session:"1",chapter:"introduction",animation:"p1s1",imgext:"jpg"})))},Object.defineProperty(t,"is",{get:function(){return"app-home"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return""},enumerable:!0,configurable:!0}),t}();t.AppAnimation=i,t.AppHome=n,Object.defineProperty(t,"__esModule",{value:!0})});